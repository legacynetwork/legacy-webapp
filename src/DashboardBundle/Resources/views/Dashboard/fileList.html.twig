
{% extends "::dashboardLayout.html.twig" %}

{% set title = "Files" %}

{% block body %}

<style>


.divFile {
	height: 200px;
	background-color: #f9f9f9;
	margin: 20px; 
	position: relative;
	border: 1px solid #cfcfcf;
}

.formFile
{
	display: none;
	font-weight: bold;
	text-align: center;
	color: #555;
	width: 100%;
	height: 100%;
	border: 2px dashed #555;
	cursor: default;
}

form {
	height: 100%;
	width: 100%;
}

.divFileDownload {
	position: absolute;
	bottom: 0px;
	width: 100%;
	text-align: center;
	padding-bottom: 20px;
}

.divFileExtension {
	width: 100%;
	text-align: center;
	font-size: 46px;
	color: #6C7A89;
	line-height: 160px;
}

.spanFileTitle {
	position: absolute;
	top: 10px;
	padding: 3px;
	width: 100%;
	text-align: center;
	background-color: rgba(255, 255, 255, 0.75);
}

.spanFileTitle:hover {
	background-color: rgba(255, 255, 255, 1);
}

.btn-download {
	background-color: rgba(65, 131, 215, 0.7);
}

.divFileSee {
	max-width: 100%;
	max-height: 100%;
	height: 100%;
	width: 100%;
}

#inputFileNew {
	background-color: #333;
	border: 5px solid #446CB3;
	position: relative;
}

#inputFileNew:hover {
	cursor: pointer;
}

#inputFileNew:after {
  content: "Drag a new file here";
  color: white;
  background: #4183D7;
  width: 100%;
  position: absolute;
  left: 0px;
  height: 100%;
  text-align: center;
  vertical-align: middle;
  line-height: 180px;
  font-size: 26px;
}

</style>

<div class="row">

	<div class="col-sm-4">
	
		<div class="divFile">
			<form id="formFileNew" method="post" ENCTYPE="multipart/form-data">
				<input id="inputFileNew" name="inputFileNew" type="file" class="formFile" />
			</form>
		</div>
	
	</div>
	
	{% for file in app.user.files %}
	
		<div class="col-sm-4">
		
			<div class="divFile" {% if file.isImage %} style="background: url();" {% endif %}>
				{% if file.isPdf %}
					<embed class="divFileSee" src="{{ path('dashboard_file_download', { 'id': file.id })  }}" type='application/pdf' />			
				{% elseif file.isImage %}
					<img class="divFileSee" src="{{ path('dashboard_file_download', { 'id': file.id })  }}"  />
				{% else %}	
					<div class="divFileExtension">
						{{ file.extension }}
					</div>
				{% endif %}	
					
				<span class="spanFileTitle">	
					{{ file.title }}
				</span>
				
				<div class="divFileDownload">
					<a class="btn btn-primary btn-download" target="_blank" href="{{ path('dashboard_file_download', { 'id': file.id })  }}">
						Download
					</a>
				</div>
				
			</div>
		
		</div>
	
	{% endfor %}


</div>



<script type="text/javascript">

$( "#inputFileNew" ).change(function(event) {
	$( "#formFileNew" ).submit();
});
	
$( "#formFileNew" ).submit(function(event) {
	event.preventDefault();

	var form = $( "#formFileNew" ).get(0);
	var formData = new FormData(form);

console.log(formData);
	
	 var DATA = '';
	  	$.ajax ({
	      type: "POST",
	      url: "{{ path('dashboard_file_edit')  }}",
	      data: formData,
	      cache: false,
		  processData: false,
		  contentType: false,
	      success: function(data) {
			window.location.reload();
	      }
	     });
	
});

</script>	

{% endblock %}